{% extends "base.html" %}
{% load static %}

{% block content %}
    <div class="container-fluid">
        <div class="row justify-content-center">
            <div class="col-sm-12 col-md-10 col-lg-8 col-xl-6 review-section" id="review-section-top">
                <div class="review-phone">
                    <h1 class="mb-0 review-title-sm">{{ phone.name }}| </h1>
                    <h1 class="mb-0 review-title-sm" id="review-phone-rating">{{ phone.rating }}| </h1>
                    <span class="text-left star-rating">
                        <input type="hidden" name="rating" id="rating_1" value="1">
                        <a onclick="setRating(1);"><i class="rating-star fa-2x far fa-star"></i></a>
                        
                        <input type="hidden" name="rating" id="rating_2" value="2">
                        <a onclick="setRating(2);"><i class="rating-star fa-2x far fa-star"></i></a>
    
                        <input type="hidden" name="rating" id="rating_3" value="3">
                        <a onclick="setRating(3);"><i class="rating-star fa-2x far fa-star"></i></a>
    
                        <input type="hidden" name="rating" id="rating_4" value="4">
                        <a onclick="setRating(4);"><i class="rating-star fa-2x far fa-star"></i></a>
    
                        <input type="hidden" name="rating" id="rating_5" value="5">
                        <a onclick="setRating(5);"><i class="rating-star fa-2x far fa-star"></i></a>
                    </span>
                </div>
            </div>
        </div>
        <div class="row justify-content-center">
            <div class="col-sm-2 col-md-4 col-lg-3 col-xl-2 review-section" id="review-section-bottom-left">
                <a href="{% url 'phone_detail' phone.id %}"><img src="{{ phone.img_1.url }}" class="review-image" alt="{{ phone.name }}"></a>
            </div>
            <div class="col-sm-10 col-md-6 col-lg-5 col-xl-4 review-section" id="review-section-bottom-right">
                <form action="{% url 'add_review' phone.id %}" method="POST">
                    {% csrf_token %}

                    <label class="review-label" for="title">Review title</label>
                    <br>
                    <input type="text" name="review_title" id="title" class="review-input">
                    <br>
                    <label class="review-label" for="body">Review body</label>
                    <textarea type="textarea" name="review_body" id="body" class="review-input review-textbox"></textarea>
                    <br>
                    <input type="hidden" id="rating" name="rating">
                    <button class="prime-btn review-btn" type="submit">Submit review</button>
                </form>
            </div>
        </div>
    </div>
{% endblock %}

{% block postloadjs %}
    {{ block.super }}
    <script type="text/javascript">
        function setRating(value) {
            document.getElementById("rating").value = document.getElementById(`rating_${value}`).value;
            console.log(value)

            // Code below from https://www.youtube.com/watch?v=iz1GB_q5txM
        }
        
    </script>
    <script text="text/javascript">
        const ratingStar = [...document.getElementsByClassName("rating-star")];
        function ratings(stars) {
            var starActive = "rating-star fas fa-2x fa-star";
            var starInactive = "rating-star far fa-2x fa-star";
            var starsLength = stars.length;
            let i;

            stars.map((star) => {
                star.onclick = () => {
                    i = stars.indexOf(star);

                    if (star.className===starInactive) {
                        for (i; i >= 0; --i) stars[i].className = starActive;
                    } else {
                        for (i; i < starsLength; ++i) stars[i].className = starInactive;
                    }
                };
            });
        }
        ratings(ratingStar);

    </script>
    <!-- Rating star JS -->
    <!-- https://dev.to/leonardoschmittk/how-to-make-a-star-rating-with-js-36d3 -->
{% endblock %}